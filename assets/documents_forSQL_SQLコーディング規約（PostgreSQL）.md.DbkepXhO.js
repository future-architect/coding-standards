import{_ as i,C as n,c as l,o as e,G as p,a4 as t}from"./chunks/framework.BpG6BfwF.js";const g=JSON.parse('{"title":"SQLコーディング規約（PostgreSQL）","description":"","frontmatter":{"sidebarDepth":4,"title":"SQLコーディング規約（PostgreSQL）","author":"Future Enterprise Coding Standards","head":[["meta",{"name":"keywords","content":"SQLコーディング規約,PostgreSQL,コーディング規約,SQL"}]]},"headers":[],"relativePath":"documents/forSQL/SQLコーディング規約（PostgreSQL）.md","filePath":"documents/forSQL/SQLコーディング規約（PostgreSQL）.md"}'),h={name:"documents/forSQL/SQLコーディング規約（PostgreSQL）.md"};function k(r,s,d,c,b,o){const a=n("page-title");return e(),l("div",null,[p(a),s[0]||(s[0]=t(`<p>本コーディング規約は、世の中のシステム開発プロジェクトのために無償で提供致します。<br> ただし、掲載内容および利用に際して発生した問題、それに伴う損害については、フューチャー株式会社は一切の責務を負わないものとします。<br> また、掲載している情報は予告なく変更することがございますので、あらかじめご了承下さい。</p><h2 id="はじめに" tabindex="-1">はじめに <a class="header-anchor" href="#はじめに" aria-label="Permalink to &quot;はじめに&quot;">​</a></h2><h3 id="前提条件" tabindex="-1">前提条件 <a class="header-anchor" href="#前提条件" aria-label="Permalink to &quot;前提条件&quot;">​</a></h3><p>本書は、SQL コーディング規約についてまとめたものである。<br> 今回 RDBMS として採用する PostgreSQL での SQL の使用を前提に記述している。</p><h2 id="sql-コーティング規約-可読性・管理性" tabindex="-1">SQL コーティング規約（可読性・管理性） <a class="header-anchor" href="#sql-コーティング規約-可読性・管理性" aria-label="Permalink to &quot;SQL コーティング規約（可読性・管理性）&quot;">​</a></h2><p>本章では可読性・管理性を高めることを目的としたコーディング規約について記載する。</p><h3 id="書式全般" tabindex="-1">書式全般 <a class="header-anchor" href="#書式全般" aria-label="Permalink to &quot;書式全般&quot;">​</a></h3><p>書式全般についてのコーディング規約を下記に示す。</p><ul><li>1 行につき、1 文のみを記述する。</li><li>SQL 中のインデントは、Java コーディング規約にあわせて半角スペースではなくタブ文字とする。</li><li>ヘボン式ローマ字を使用する。</li><li>外来語に関しては、原語の綴りを使用する。</li><li>横は 80 文字を目安に改行する。</li><li>定数を条件に用いる場合やインライン・ビューで取得したいデータなど開発者の意図はコメントにて記載する。</li></ul><h3 id="予約語" tabindex="-1">予約語 <a class="header-anchor" href="#予約語" aria-label="Permalink to &quot;予約語&quot;">​</a></h3><p>予約語に対しては、小文字を使用する。(例 ： <code>select</code>、<code>insert</code>、<code>update</code>、<code>delete</code> 等)</p><h3 id="予約語以外" tabindex="-1">予約語以外 <a class="header-anchor" href="#予約語以外" aria-label="Permalink to &quot;予約語以外&quot;">​</a></h3><p>予約語以外に対しても、予約語と同様に小文字を使用する。(例 ： オブジェクト名、カラム名 等)</p><h3 id="短縮名称" tabindex="-1">短縮名称 <a class="header-anchor" href="#短縮名称" aria-label="Permalink to &quot;短縮名称&quot;">​</a></h3><p>SQL 中に記述するエイリアス名など単語の短縮について示す。</p><ol><li><p>外来語に関しては、原語の短縮形を使用する。短縮形が存在しない場合には、母音を抜かして表記する。<br> 例) corporation → corp / computer → cmptr</p></li><li><p>ローマ字の短縮は、単語の区切れの頭文字、または母音を抜かした子音字等を利用する。<br> 例) nichijo → nchj</p></li></ol><ul><li>カラムには必ずテーブルエイリアスを付与する</li><li>テーブルのエイリアスは必ず付与すること。<br> 必要ない場合（単一テーブルへの SELECT 等）も必ず付与すること<br> また、テーブルのエイリアス名は同 SQL 文の中で重複しないように命名すること。<br> （副問い合わせで利用したエイリアス名をメインの SQL 中のエイリアス名に利用しない。など）</li></ul><h3 id="文字コード" tabindex="-1">文字コード <a class="header-anchor" href="#文字コード" aria-label="Permalink to &quot;文字コード&quot;">​</a></h3><p>SQL ファイルの文字コード（エンコーディング）は Java ソースファイルと同じく『 Unicode UTF-8 』で保存する。</p><h3 id="不要な空白文字-スペース-は除去する" tabindex="-1">不要な空白文字（スペース）は除去する <a class="header-anchor" href="#不要な空白文字-スペース-は除去する" aria-label="Permalink to &quot;不要な空白文字（スペース）は除去する&quot;">​</a></h3><p>不要な空白文字（スペース）は除去すること。</p><h3 id="sql-文の整形" tabindex="-1">SQL 文の整形 <a class="header-anchor" href="#sql-文の整形" aria-label="Permalink to &quot;SQL 文の整形&quot;">​</a></h3><p>DML 文の節に対する予約語は左揃えにする。<br> 項目ごとに改行を入れ、項目の前にはインデントを挿入する。カンマは項目の前へ記入する。<br> Java ソースファイルのようにファイルの先頭にコメント行を入れると DB 分析作業に支障があるため禁止とする。<br> よって SQL ファイルの先頭は必ず<code>select</code>、<code>update</code>、<code>insert</code>、<code>delete</code>の何れかになる。</p><p>物理カラム名、テーブル名に対応する論理名を入れる場合、その後ろに単数行コメント（<code>-- </code>）にて記述する。<br> SQL 内に挿入する単数行コメントは、<code>/*（半角スペース）コメント本文（半角スペース）*/</code> で行う。<br><code>,</code>（カンマ）と<code>AND</code>については各行の先頭に記述する。（以下の例を参照のこと）<br> SQL フレームワークで実行する SQL の場合、SQL ステートメントの終わりを示す<code>;</code>（セミコロン）は記述しない。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	処理名</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	column1	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	column2	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table1	tbl1	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- テーブル1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>WHERE 句の<code>=</code>、<code>!=</code>、<code>is</code>（<code>is null</code>の<code>is</code>）の縦位置は揃える。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ten_no</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ten_no</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">kamoku_cd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	!=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&#39;1&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">anken_no</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	is</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	null</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="select-文" tabindex="-1">SELECT 文 <a class="header-anchor" href="#select-文" aria-label="Permalink to &quot;SELECT 文&quot;">​</a></h4><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	column1	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	column2	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table1	tbl1	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- テーブル1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">order by</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="insert-文" tabindex="-1">INSERT 文 <a class="header-anchor" href="#insert-文" aria-label="Permalink to &quot;INSERT 文&quot;">​</a></h4><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">insert</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">into</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table1	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- テーブル1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	column1	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	column2	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	column3	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	value1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	value2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	value3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="update-文" tabindex="-1">UPDATE 文 <a class="header-anchor" href="#update-文" aria-label="Permalink to &quot;UPDATE 文&quot;">​</a></h4><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">update</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table1	tbl1	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- テーブル1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	100</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	-- カラム2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	100</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	-- カラム3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	10</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="delete-文" tabindex="-1">DELETE 文 <a class="header-anchor" href="#delete-文" aria-label="Permalink to &quot;DELETE 文&quot;">​</a></h4><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">delete</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table1	tbl1	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- テーブル1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="and-副問い合わせ" tabindex="-1">AND（副問い合わせ） <a class="header-anchor" href="#and-副問い合わせ" aria-label="Permalink to &quot;AND（副問い合わせ）&quot;">​</a></h4><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	xxx	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		select</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">			tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			table1	tbl1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="case-式" tabindex="-1">CASE 式 <a class="header-anchor" href="#case-式" aria-label="Permalink to &quot;CASE 式&quot;">​</a></h4><p>CASE 式は下記のように記載すること。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">case</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	when</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		xxx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hoge</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	yyy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fuga</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	xxx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fuga</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	yyy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fuga</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>case</code>、<code>when</code>、<code>then</code>、<code>else</code>の後に改行を挿入すること。<br><code>case</code>の後、<code>end</code>の前までは 1 インデント挿入すること。</p><h4 id="in-句" tabindex="-1">IN 句 <a class="header-anchor" href="#in-句" aria-label="Permalink to &quot;IN 句&quot;">​</a></h4><p>カンマの後にスペースを１文字入れる。</p><h4 id="比較演算子" tabindex="-1">比較演算子 <a class="header-anchor" href="#比較演算子" aria-label="Permalink to &quot;比較演算子&quot;">​</a></h4><p>比較演算子の前後にタブ（またはスペース）を１文字入れる。</p><h4 id="改行位置" tabindex="-1">改行位置 <a class="header-anchor" href="#改行位置" aria-label="Permalink to &quot;改行位置&quot;">​</a></h4><p>select 句、order by 句、group by 句等は最初に出現するカラムとカラムの区切りのカンマ前に改行を入れること。<br> select の from 句の最初に出現するテーブルと結合テーブルの区切りのカンマ前に改行を入れること。<br> where 句の on 句の各条件文の（and や or の）前に改行を入れること。<br> 命令句の後は、ヒント句が挿入できるように改行すること。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	column1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	column2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table1	t1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	table2	t2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column4</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">order by</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="with-句" tabindex="-1">WITH 句 <a class="header-anchor" href="#with-句" aria-label="Permalink to &quot;WITH 句&quot;">​</a></h4><p>with の前後に改行を挿入すること<br> また、インデントは下記のように記述すること</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラムエイリアスあり</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name1   (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        col_alias1  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム１</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ,   col_alias2  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム２</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        select</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ・・・</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   name2   (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        col_alias1  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム１</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ,   col_alias2  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラム２</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        select</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ・・・</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- カラムエイリアスなし</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name1   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        select</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ・・・</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   name2   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        select</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ・・・</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="limit-句-offset-句" tabindex="-1">LIMIT 句 OFFSET 句 <a class="header-anchor" href="#limit-句-offset-句" aria-label="Permalink to &quot;LIMIT 句 OFFSET 句&quot;">​</a></h4><p>LIMIT、OFFSET の前に改行を挿入すること</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  column1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    table1  tbl1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">order by</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    desc</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">limit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">offset </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="hint-句" tabindex="-1">HINT 句 <a class="header-anchor" href="#hint-句" aria-label="Permalink to &quot;HINT 句&quot;">​</a></h4><p>HINT 句は独立した行で記載すること<br> HINT 内容にはインデントを付けること</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/*+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	ここにhintを記載</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	column1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	table1	tbl1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="コメント" tabindex="-1">コメント <a class="header-anchor" href="#コメント" aria-label="Permalink to &quot;コメント&quot;">​</a></h3><ul><li><p>修正コメント</p><p>（修正コメントが必要な場合、）<br> 処理追加の際、追加行の 1 行目の前と最終行の次の行にコメントを入れる。単一行の場合は、同一行の最後にコメントをつける。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 2004/04/23 仕様変更管理番号 ADD(または、MOD、DEL) 変更者名 S ←　修正開始点コメント</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(追加処理)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 2004/04/23仕様変更管理番号 ADD(または、MOD、DEL) 変更者名 E ←　修正終了点コメント</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p>単数行コメント</p><p>SQL 内で使用する単数行コメント（カラムコメントなど）には、「 <code>--</code> 」を使用する。</p></li><li><p>複数行コメント</p><p>「 <code>/*</code> <code>*/</code> 」を使用する。下記に例を示す。<br> なお、前述で触れたとおり、SQL ファイルの先頭にコメントを記述することは禁止とする。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**********************************************************************/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * コメントを始めるスラッシュとアスタリスクは、それだけを１行に置く。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * それから、コメント・ブロック内の各行は縦にアスタリスクを置き</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * コメントがあることを強調する。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 最後に、アスタリスクとスラッシュは、それだけを１行に置く。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**********************************************************************/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li><li><p>複数行コメントアウト</p><p>複数行をコメントアウトする場合は、各行を「<code>--</code>」でコメントアウトする。<br> 「 <code>/*</code> <code>*/</code> 」を使用すると、その中に「 <code>/*</code> <code>*/</code> 」が存在した場合、コメントアウトが途中で切れてしまう恐れがあるため、<br> 使用しない。</p></li><li><p>論理名の記載</p><p><code>select</code>・<code>insert</code>・<code>update</code>・<code>merge</code>のカラム名記述箇所には単数行コメントでカラムの論理名を記載する。<br><code>select</code>・<code>insert</code>・<code>update</code>・<code>delete</code>・<code>merge</code>のテーブル名記述箇所には単数行コメントでテーブルの論理名を記載する。<br> 論理名は ERD 等で定義された論理名と必ず一致させること。</p></li></ul><h3 id="型変換" tabindex="-1">型変換 <a class="header-anchor" href="#型変換" aria-label="Permalink to &quot;型変換&quot;">​</a></h3><p>代入や WHERE 句の条件設定などでデータ・タイプが異なる場合、明示的にタイプ変換を行う。（暗黙の型変換は使用しない）</p><h3 id="比較演算子-1" tabindex="-1">比較演算子 <a class="header-anchor" href="#比較演算子-1" aria-label="Permalink to &quot;比較演算子&quot;">​</a></h3><p>「等しくない」を示す演算子は「<code>!=</code>」を利用する。「<code>&lt;&gt;</code>」も動作するが統一の観点から利用しない。</p><h3 id="order-by-句" tabindex="-1">ORDER BY 句 <a class="header-anchor" href="#order-by-句" aria-label="Permalink to &quot;ORDER BY 句&quot;">​</a></h3><p><code>order by</code> 数字の構文は使用せずに、カラム名を記載する。</p><h3 id="group-by-句" tabindex="-1">GROUP BY 句 <a class="header-anchor" href="#group-by-句" aria-label="Permalink to &quot;GROUP BY 句&quot;">​</a></h3><p><code>group by</code> 数字の構文は使用せずに、カラム名を記載する。</p><p>集約関数を利用する場合は必ず記載すること。（省略可能であっても省略しない）</p><h3 id="exists-句" tabindex="-1">EXISTS 句 <a class="header-anchor" href="#exists-句" aria-label="Permalink to &quot;EXISTS 句&quot;">​</a></h3><p>EXISTS 句を記載する際、サブクエリになる SELECT 句の指定は定数「<code>1</code>」とする。<br> 「<code>*</code>」（ワイルドカード）や「<code>&#39;X&#39;</code>」は統一の観点から利用しない。<br> また「<code>*</code>」（ワイルドカード）についてはパフォーマンスの観点からも禁止とする。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	exists</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		select</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">			1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			foo	f</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">			f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">key</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="as-句" tabindex="-1">AS 句 <a class="header-anchor" href="#as-句" aria-label="Permalink to &quot;AS 句&quot;">​</a></h3><p>トップレベルの SELECT 句には必ず<code>as</code>句を記載し別名を付ける。<br> 同一の名前であっても AS 句を付与する。<br> また、「<code>as</code>」は省略可能であるが、省略はしないこと。</p><h3 id="where-句" tabindex="-1">WHERE 句 <a class="header-anchor" href="#where-句" aria-label="Permalink to &quot;WHERE 句&quot;">​</a></h3><ul><li><p>論理名の記載<br> WHERE 句でカラムと式を比較する際は左辺がカラムになるように記載すること。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">column1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">amount2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">amount3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">amount4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p>条件式の順序<br> 原則として、WHERE 句で条件式を列挙する際、下記の順序を守ること。</p><ol><li>テーブル単位にまとめて順番に記述する<br> この際、テーブルの順序は FROM 句に記述した順序に準ずること。</li><li>1.のテーブル単位の中で絞り込み条件をまず記述し、その後結合条件を記述する。</li></ol><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	a_table	a	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- a_table</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	b_table	b	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- b_table</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,	c_table	c	</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- c_table</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- a_tableの絞り込み</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">key1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	?</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">key2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	?</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- b_tableの絞り込み</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">key1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	?</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">key2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	?</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- b_tableの結合条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- c_tableの絞り込み</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">key1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	?</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">key2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	?</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- c_tableの結合条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul><h3 id="count-文" tabindex="-1">COUNT 文 <a class="header-anchor" href="#count-文" aria-label="Permalink to &quot;COUNT 文&quot;">​</a></h3><p>レコード数を数える COUNT 文の記述は<code>count(*)</code>と記述する。<br><code>count(1)</code>・<code>count(&#39;x&#39;)</code> ・<code>count(key1)</code>という記載は NG。</p><h3 id="文字列リテラル" tabindex="-1">文字列リテラル <a class="header-anchor" href="#文字列リテラル" aria-label="Permalink to &quot;文字列リテラル&quot;">​</a></h3><h4 id="エスケープシーケンス" tabindex="-1">エスケープシーケンス <a class="header-anchor" href="#エスケープシーケンス" aria-label="Permalink to &quot;エスケープシーケンス&quot;">​</a></h4><p>文字列リテラル中のシングルクォーテーションのエスケープは「 <code>&#39;&#39;</code> 」とシングルクォーテーションを二つつなげた記述をする。<br> 「 <code>\\&#39;</code> 」も同様の結果が得られるが円マーク（バックスラッシュ）によるエスケープは利用しない。<br> 円マークをエスケープせざるを得ないときのみ円マークによるエスケープ利用して良いが、<br> 円マークを文字列リテラルで表現する必要のある設計自体を避けること。</p><p>※PostgreSQL は設定によって円マーク（バックスラッシュ）によるエスケープを無効にできます。（デフォルト無効）<br> 円マークをエスケープするときは、自プロジェクトでどちらに設定されているか確認してください。</p><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">update</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    table_a</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    text_data   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   &#39;that&#39;&#39;s right&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>悪い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">update</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    table_a</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    text_data   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   &#39;that\\&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s too bad</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="sql-コーディング規約-パフォーマンス性" tabindex="-1">SQL コーディング規約（パフォーマンス性） <a class="header-anchor" href="#sql-コーディング規約-パフォーマンス性" aria-label="Permalink to &quot;SQL コーディング規約（パフォーマンス性）&quot;">​</a></h2><p>本章ではパフォーマンス性を高めることを目的としたコーディング規約について記載する。</p><h3 id="検索" tabindex="-1">検索 <a class="header-anchor" href="#検索" aria-label="Permalink to &quot;検索&quot;">​</a></h3><p>検索処理におけるコーディング規約を下記に示す。</p><ul><li><p>中間一致、後方一致検索はインデックスを利用できないため避ける</p></li><li><p>検索条件で<code>=</code>（等号）を使用できる場合は必ず使用する</p><p><code>a=1 or a=2</code>とする方が<code>a&gt;0 and a&lt;3</code>などと記述するのよりパフォーマンス上優位な場合が多い。<br> これは <code>a</code> にインデックスがある場合、<code>=</code>であれば、インデックスが有効に使われるためである。</p></li><li><p>可能な限り検索条件にパーティションキーの値を指定する</p></li><li><p>全列ワイルドカード「<code>*</code>」の使用はせず、カラム名を明記する</p></li><li><p>インデックスによる検索を指定したい場合、下記の記載を行わない</p><ul><li><p>インデックスカラムを含む演算に対して条件指定</p><p>悪い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	100</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* NGパターン 右辺で演算してください */</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>インデックスカラムに関数を通した値に対して条件指定</p><p>悪い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* NGパターン 右辺に関数を通してください */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">to_char(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;YYYYMMDD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&#39;20151231&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	&gt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	to_date(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;20160101&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;YYYYMMDD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>インデックスカラムを<code>OR</code>で条件指定（禁止ではないが原則行わない）</p><p>悪い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/* NGパターンINDEXが利用されない場合があります。他の方法を検討してください */</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	or</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	tbl1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">col1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li></ul><h3 id="挿入" tabindex="-1">挿入 <a class="header-anchor" href="#挿入" aria-label="Permalink to &quot;挿入&quot;">​</a></h3><p>挿入処理におけるコーディング規約を下記に示す。</p><ul><li>全列ワイルドカード「<code>*</code>」の使用はせず、カラム名を明記する。</li></ul><h3 id="更新" tabindex="-1">更新 <a class="header-anchor" href="#更新" aria-label="Permalink to &quot;更新&quot;">​</a></h3><p>更新処理におけるコーディング規約を下記に示す。</p><ul><li>主キーの値の UPDATE は原則行わない。外部キーがあればエラーになる。<br> 外部キーが無い場合でも、事実上、主キーの値を利用して、検索、更新する場合は、リンクが切れてしまう。</li><li>パーティションキーの UPDATE は原則行わない。</li><li>VIEW を使用するデータ更新は禁止。更新は実表に対して行う。</li></ul><h3 id="削除" tabindex="-1">削除 <a class="header-anchor" href="#削除" aria-label="Permalink to &quot;削除&quot;">​</a></h3><p>削除処理におけるコーディング規約を下記に示す。</p><ul><li>大量件数（数百万件レベル）の delete 文発行は避ける。</li></ul><h3 id="distinct-句" tabindex="-1">DISTINCT 句 <a class="header-anchor" href="#distinct-句" aria-label="Permalink to &quot;DISTINCT 句&quot;">​</a></h3><p>DISTINCT は、暗黙のソート処理が行われる可能性があるため性能劣化につながる。<br> EXISTS 句の使用・代替を検討すること。</p><p>悪い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    distinct</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">no</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  dept_no</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  dept_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    department  d</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   employee    e</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">no</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dept_no</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   -- 社員が一人以上属している部門を取得</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>良い例：</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">no</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  dept_no</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  dept_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    department  d</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    exists</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        select</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            employee    e</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        where</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">no</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dept_no</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   -- 社員が一人以上属している部門を取得</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="in-句-1" tabindex="-1">IN 句 <a class="header-anchor" href="#in-句-1" aria-label="Permalink to &quot;IN 句&quot;">​</a></h3><p>IN 句は最大 1000 個まで指定できるが、200 個程度でも ORA エラーが発生するケースがある。<br> また IN 句の少しだけ異なる SQL が大量に発行されると CPU 高騰やメモリ枯渇を招く。<br> 従って 100 を超えるような長い IN 句は使用せず、一時表を利用して <code>in (select ・・・ from 一時表)</code>のように書き換える。</p><h3 id="not-in-句" tabindex="-1">NOT IN 句 <a class="header-anchor" href="#not-in-句" aria-label="Permalink to &quot;NOT IN 句&quot;">​</a></h3><p>原則<code>not in（select～）</code>は使用せずに、<code>not exists (select～)</code>を使用する。<br><code>NOT IN</code>句は、内部的にソートマージの結合をすることでテーブルをフルスキャンする場合があるため、性能が悪化する可能性がある。</p><h3 id="union-句" tabindex="-1">UNION 句 <a class="header-anchor" href="#union-句" aria-label="Permalink to &quot;UNION 句&quot;">​</a></h3><p><code>union</code>は<code>distinct</code>処理が含まれパフォーマンス上問題があるため、<code>union all</code>を使用する。</p><h3 id="select-for-update" tabindex="-1">SELECT FOR UPDATE <a class="header-anchor" href="#select-for-update" aria-label="Permalink to &quot;SELECT FOR UPDATE&quot;">​</a></h3><ul><li><code>select for update</code>で複数行にロックをかける場合、同時実行されるとデットロックを起こす可能性があるため、１件のロックでない場合は<code>order by</code>を指定する。</li></ul><h3 id="分析関数" tabindex="-1">分析関数 <a class="header-anchor" href="#分析関数" aria-label="Permalink to &quot;分析関数&quot;">​</a></h3><p>分析関数の使用は可能だが、性能悪化を招く恐れがあるため、特性を知らない方は DBA に相談する。</p><h3 id="インデックス" tabindex="-1">インデックス <a class="header-anchor" href="#インデックス" aria-label="Permalink to &quot;インデックス&quot;">​</a></h3><p>インデックスの必要性については DBA で最終判断するため、必要とする場合は DBA へ相談する。</p><h3 id="外部結合" tabindex="-1">外部結合 <a class="header-anchor" href="#外部結合" aria-label="Permalink to &quot;外部結合&quot;">​</a></h3><p>外部結合する際、内部表（駆動表）はなるべく想定件数の少ない表にする。</p><hr><h2 id="license" tabindex="-1">License <a class="header-anchor" href="#license" aria-label="Permalink to &quot;License&quot;">​</a></h2><p><a href="https://creativecommons.org/licenses/by/4.0/deed.ja" target="_blank" rel="noreferrer"><img src="https://licensebuttons.net/l/by/4.0/88x31.png" alt="CC-By-4.0"></a></p>`,135))])}const u=i(h,[["render",k]]);export{g as __pageData,u as default};
